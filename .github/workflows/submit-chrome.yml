name: 'Submit to Chrome'
on:
  workflow_dispatch:

jobs:
  call-build:
    uses: ./.github/workflows/build.yml
    with:
      browser: chrome

  submit:
    runs-on: ubuntu-latest
    needs: [call-build]
    steps:
      - name: Download Chrome artifact
        uses: actions/download-artifact@v4
        with:
          name: chrome-mv3-prod.zip

      - name: Browser Platform Publish for Chrome
        uses: PlasmoHQ/bpp@v3
        with:
          keys: ${{ secrets.SUBMIT_KEYS_CHROME }}
          chrome-file: chrome-mv3-prod.zip
          verbose: true
